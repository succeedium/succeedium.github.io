import{_ as a}from"./chunks/data_upload.BprzPkGi.js";import{_ as o,a as n,b as t,c as s}from"./chunks/subset_formula.BUGDK4kU.js";import{_ as i,c as r,o as l,ag as m}from"./chunks/framework.BG_SpCm2.js";const u="/teamone/img/functions/teamone_formula.png",c="/teamone/img/functions/static_mode.png",d="/teamone/img/functions/quite_mode.png",p="/teamone/img/functions/zero_values.png",h="/teamone/img/functions/default_elements.png",g="/teamone/img/functions/alternative_hierarchy.png",f="/teamone/img/functions/teamone_formula_insert.png",b="/teamone/img/functions/mdx_formula_static_columns.png",y="/teamone/img/functions/mdx_formula_mdx_expression.png",v="/teamone/img/functions/mdx_formula_cube_view.png",q="/teamone/img/functions/username_formula.png",x="/teamone/img/functions/updated_formula.png",O=JSON.parse('{"title":"TeamOne","titleTemplate":"Formulas","description":"","frontmatter":{"title":"TeamOne","titleTemplate":"Formulas"},"headers":[],"relativePath":"doc/formulas.md","filePath":"doc/formulas.md"}'),E={name:"doc/formulas.md"};function w(_,e,k,T,A,S){return l(),r("div",null,e[0]||(e[0]=[m('<h1 id="formulas" tabindex="-1">Formulas <a class="header-anchor" href="#formulas" aria-label="Permalink to &quot;Formulas&quot;">​</a></h1><h2 id="teamone-function" tabindex="-1">TEAMONE() Function <a class="header-anchor" href="#teamone-function" aria-label="Permalink to &quot;TEAMONE() Function&quot;">​</a></h2><p>Using the <em><strong>TEAMONE()</strong></em> function you can easily retrieve data from IBM Planning Analytics. It expects the following arguments:</p><ul><li><em><strong>cubeName</strong></em> - The name of the cube to retrieve data from.</li><li><em><strong>rangeRows</strong></em> - The selected cells representing your rows.</li><li><em><strong>rangeColumns</strong></em> - The selected cells representing your columns.</li><li><em><strong>rangeTitles</strong></em> - The selected cells representing your context elements.</li><li><em><strong>options</strong></em> - Flags to &quot;A&quot;utofit columns, use &quot;F&quot;ormatted values, allow &quot;U&quot;pdates, use &quot;S&quot;tatic values, &quot;R&quot;everse sign, &quot;Q&quot;uiet mode, and display &quot;Z&quot;ero values instead of blanks. You can combine flags: &quot;AFSQZ&quot; - fetch formatted static values, autofit columns, and enable quiet mode.</li><li><em><strong>solveOrder</strong></em> - Specifies the formula evaluation order. If omitted, the default value of 0 will be used.</li></ul><p><img src="'+u+`" alt="img" data-zoomable=""></p><p>For rows and columns, you can select single or multiple cells, and you can also include empty rows or columns:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// Retrieve data from Revenue cube, use formatted values and autofit columns</span></span>
<span class="line"><span>=TEAMONE(&quot;Revenue&quot;, A4:A5, B2:C3, A2:A3,&quot;AF&quot;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// No columns (argument #3 is skipped), hardcoded title element</span></span>
<span class="line"><span>=TEAMONE(&quot;Revenue&quot;, A4:A5, , &#39;Gross Revenue&#39;)</span></span></code></pre></div><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=0" target="_blank" rel="noreferrer">=TEAMONE() formula example</a></p><h3 id="teamone-and-other-google-sheets-functions" tabindex="-1">TEAMONE and other Google Sheets functions <a class="header-anchor" href="#teamone-and-other-google-sheets-functions" aria-label="Permalink to &quot;TEAMONE and other Google Sheets functions&quot;">​</a></h3><p>Please note that you can only use one TEAMONE() function per cell. However, you can combine it with other Google Sheets functions:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// Get a SUM of all values returned by TEAMONE() function</span></span>
<span class="line"><span>=SUM( TEAMONE(B2,B10:C16,D8:G9,B5:B7) )</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// Flips the sign by multiplying each value by -1</span></span>
<span class="line"><span>=ARRAYFORMULA( -1 * TEAMONE(B2,B10:C16,D8:G9,B5:B7) )</span></span></code></pre></div><p>See more <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=77581571#gid=77581571" target="_blank" rel="noreferrer">=ARRAYFORMULA() formula examples</a></p><h3 id="autofit-columns" tabindex="-1">Autofit Columns <a class="header-anchor" href="#autofit-columns" aria-label="Permalink to &quot;Autofit Columns&quot;">​</a></h3><p>Use the &quot;A&quot; flag in the TEAMONE() function to automatically resize columns to fit the cell in each column that has the widest content.</p><h3 id="formatted-values" tabindex="-1">Formatted Values <a class="header-anchor" href="#formatted-values" aria-label="Permalink to &quot;Formatted Values&quot;">​</a></h3><p>Use the &quot;F&quot; flag in the TEAMONE() function to retrieve formatted cube values from IBM Planning Analytics. Alternatively, you can apply formatting in Google Sheets, which is easier and provides more formatting options.</p><h3 id="static-values" tabindex="-1">Static Values <a class="header-anchor" href="#static-values" aria-label="Permalink to &quot;Static Values&quot;">​</a></h3><p>When using the &quot;S&quot; flag, the =TEAMONE() formula will return a single value (the very first one), and the remaining values will be printed as static. This flag is recommended when using the TEAMONE() formula with hundreds of rows and/or columns to avoid the error message:</p><p><em><strong>You have exceeded the property storage quota. Please remove some properties and try again.</strong></em></p><p>Additionally, the static mode allows you to insert calculated rows and columns between the rows and columns generated by the TEAMONE() calculation. In this mode, TEAMONE will disregard any rows where elements are not provided for the last row or column dimension (the distribution channel on the rows dimension and the year dimension on the columns in the example below):</p><p><img src="`+c+'" alt="img" data-zoomable=""></p><h3 id="update-mode" tabindex="-1">Update Mode <a class="header-anchor" href="#update-mode" aria-label="Permalink to &quot;Update Mode&quot;">​</a></h3><p>Use the &quot;U&quot; flag in the TEAMONE() function to enable data updates. The &quot;U&quot; flag also turns on static values as described above. You can submit the formula&#39;s data to IBM Planning Analytics using the <a href="./functions.html#upload-data">upload data</a> button available on the content tab.</p><p><img src="'+a+'" alt="img" data-zoomable=""></p><h3 id="quiet-mode" tabindex="-1">Quiet Mode <a class="header-anchor" href="#quiet-mode" aria-label="Permalink to &quot;Quiet Mode&quot;">​</a></h3><p>If you skip some cube dimensions, TeamOne will automatically use <em><strong>default elements</strong></em> for those dimensions and will add them to the cell notes. Use the &quot;Q&quot; flag in the TEAMONE() function to disable notes for omitted dimensions.</p><p><img src="'+d+'" alt="img" data-zoomable=""></p><h3 id="zero-values" tabindex="-1">Zero values <a class="header-anchor" href="#zero-values" aria-label="Permalink to &quot;Zero values&quot;">​</a></h3><p>Use the &quot;Z&quot; flag in the TEAMONE() function to display zero values instead of blank cells.</p><p><img src="'+p+'" alt="img" data-zoomable=""></p><h3 id="repetitive-elements" tabindex="-1">Repetitive elements <a class="header-anchor" href="#repetitive-elements" aria-label="Permalink to &quot;Repetitive elements&quot;">​</a></h3><p>If you have multiple rows and/or columns, you don&#39;t have to specify repetitive elements for each row or column. TeamOne will automatically use the same element name if the next rows/columns are blank.</p><p><img src="'+o+'" alt="img" data-zoomable=""></p><h3 id="multiple-formulas-performance" tabindex="-1">Multiple formulas performance <a class="header-anchor" href="#multiple-formulas-performance" aria-label="Permalink to &quot;Multiple formulas performance&quot;">​</a></h3><p>If using the same title elements, row/column dimensions, and formula flags, TeamOne will automatically detect and build a single query for each group of similar formulas, resulting in better performance.</p><h3 id="solve-order" tabindex="-1">Solve order <a class="header-anchor" href="#solve-order" aria-label="Permalink to &quot;Solve order&quot;">​</a></h3><p>If you need to use the results of <em><strong>TEAMONE()</strong></em>, <em><strong>ATTR()</strong></em>, or <em><strong>SUBSET()</strong></em> functions as arguments for another <em><strong>TEAMONE()</strong></em>, <em><strong>ATTR()</strong></em>, or <em><strong>SUBSET()</strong></em> function, you can specify the <em><strong>solveOrder</strong></em> to control the order in which those results are recalculated. <em><strong>solveOrder</strong></em> must be 1 or greater. If omitted, the default value of 0 will be used.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>It is recommended to use the same <em>solveOrder</em> value for multiple formulas that can be recalculated at the same time, as using multiple different values might increase the time taken to recalculate all formulas.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>For both <em>=TEAMONE()</em> and <em>=ATTR()</em> functions, you can skip the <em>options</em> argument before specifying the <em>solveOrder</em> value. For example:</p><p><code>=ATTR(&#39;product&#39;, &#39;21002&#39;, &#39;Product Color&#39;, 2)</code></p></div><h3 id="default-elements" tabindex="-1">Default elements <a class="header-anchor" href="#default-elements" aria-label="Permalink to &quot;Default elements&quot;">​</a></h3><p>If you do not include elements from all cube dimensions, TeamOne will automatically select the default member for each skipped dimension and add a corresponding note to the cell. Use the <a href="#quiet-mode">quiet mode</a> option to suppress notes.</p><p><img src="'+h+'" alt="img" data-zoomable=""></p><h3 id="ambiguous-element-names" tabindex="-1">Ambiguous element names <a class="header-anchor" href="#ambiguous-element-names" aria-label="Permalink to &quot;Ambiguous element names&quot;">​</a></h3><p>If you have elements with the same names in multiple dimensions, you can clarify the dimension name by using the following syntax: <code>dimension^hierarchy^element</code></p><p>You can also specify the hierarchy if needed (see below).</p><h3 id="alternative-hierarhies" tabindex="-1">Alternative hierarhies <a class="header-anchor" href="#alternative-hierarhies" aria-label="Permalink to &quot;Alternative hierarhies&quot;">​</a></h3><p>Use the <code>dimension^hierarchy^element</code> syntax to specify the dimension and hierarchy for any title element or the first element of any row/column range.</p><p><img src="'+g+`" alt="img" data-zoomable=""></p><h3 id="connection-name" tabindex="-1">Connection name <a class="header-anchor" href="#connection-name" aria-label="Permalink to &quot;Connection name&quot;">​</a></h3><p><em><strong>=TEAMONE()</strong></em> function always fetches data from the currently selected connection. Use <code>ConnectionName:CubeName</code> syntax to retrieve data from a different configured connection.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// Revenue cube in TeamOneTest environment</span></span>
<span class="line"><span>=TEAMONE(&quot;TeamOneTest:Revenue&quot;, A4:A5, B2:C3, A2:A3)</span></span></code></pre></div><h3 id="create-formulas-automatically" tabindex="-1">Create formulas automatically <a class="header-anchor" href="#create-formulas-automatically" aria-label="Permalink to &quot;Create formulas automatically&quot;">​</a></h3><p>You can let TeamOne build (autogenerate) the <em>=TEAMONE()</em> formula for you using an existing cube/view on the <em>Model</em> tab or from the exploration menu:</p><p><img src="`+f+'" alt="img" data-zoomable=""></p><h2 id="mdx-function" tabindex="-1">MDX() function <a class="header-anchor" href="#mdx-function" aria-label="Permalink to &quot;MDX() function&quot;">​</a></h2><p><em><strong>MDX()</strong></em> function allows you creating reports with dynamic rows and columns. It expects the following arguments:</p><ul><li><em><strong>cubeName</strong></em> - the cube name to retrieve data from</li><li><em><strong>rowsExpressions</strong></em> - expressions to generate yours rows</li><li><em><strong>columnExpressions</strong></em> - expressions to generate yours columns</li><li><em><strong>rangeTitles</strong></em> - select the cells representing your context elements</li><li><em><strong>options</strong></em> - &quot;F&quot; formatted values, &quot;S&quot; static values, &quot;R&quot; include empty rows, &quot;C&quot; include empty columns, &quot;H&quot; hide the column headers. You can combine flags: &quot;FSRC&quot; - fetch formatted static values include empty rows and columns.</li></ul><h3 id="dynamic-rows-and-columns" tabindex="-1">Dynamic rows and columns <a class="header-anchor" href="#dynamic-rows-and-columns" aria-label="Permalink to &quot;Dynamic rows and columns&quot;">​</a></h3><p>You can specify dimension expressions for both rows and columns using the following format: <code>dimName1^setExpression~aliasName * dimName2^setExpression~aliasName * ...</code></p><p>You can provide multiple dimension expressions separated by &quot; * &quot; (space asterisk space). Each expression should have the following structure: <code>dimName^setExpression</code></p><p>You can specify an alternative hierarchy by using the following syntax: <code>dimName^hierName^setExpression</code></p><p>You can specify an alias by using the following syntax: <code>dimName^setExpression~aliasName</code></p><p>If no alias is specified, the functinon will return the element principal names.</p><p>For the <em>setExpression</em> you can use an existing subset name, MDX, MDX mods or element list, using the same <a href="#set-expression"><em><strong>set expressions</strong></em></a> as in the <a href="#subset-function"><em><strong>=SUBSET()</strong></em></a> function.</p><p><img src="'+n+'" alt="img" data-zoomable=""> See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=1794108640#gid=1794108640" target="_blank" rel="noreferrer">=MDX() formula example with set expressions</a></p><p>The MDX() function will also return the column headers unless you specify the <em><strong>&quot;H&quot;</strong></em> option flag.</p><h3 id="dynamic-rows-and-static-columns" tabindex="-1">Dynamic rows and static columns <a class="header-anchor" href="#dynamic-rows-and-static-columns" aria-label="Permalink to &quot;Dynamic rows and static columns&quot;">​</a></h3><p>You can use the <em><strong>MDX()</strong></em> selecting a column range similar to the TEAMONE() function. TeamOne will automatically find the dimension names:</p><p><img src="'+b+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=195431724#gid=195431724" target="_blank" rel="noreferrer">=MDX() formula example with static column elements</a></p><h3 id="mdx-expression" tabindex="-1">MDX expression <a class="header-anchor" href="#mdx-expression" aria-label="Permalink to &quot;MDX expression&quot;">​</a></h3><p>You can provide an MDX expression in the <em><strong>MDX()</strong></em> function, for instance, you can copy-paste from IBM Planning Analytics Workspace:</p><p><img src="'+y+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=349641449#gid=349641449" target="_blank" rel="noreferrer">=MDX() formula example with MDX expression</a></p><h3 id="cube-view" tabindex="-1">Cube view <a class="header-anchor" href="#cube-view" aria-label="Permalink to &quot;Cube view&quot;">​</a></h3><p>You can provide a cube view name in the <em><strong>MDX()</strong></em> function using the following syntax:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cubeName^viewName</span></span></code></pre></div><p><img src="'+v+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=349641449#gid=349641449" target="_blank" rel="noreferrer">=MDX() formula example with a cube view</a></p><h2 id="attr-function" tabindex="-1">ATTR() function <a class="header-anchor" href="#attr-function" aria-label="Permalink to &quot;ATTR() function&quot;">​</a></h2><p><em><strong>ATTR()</strong></em> function retrieves the specified attribute value for the specified elements. It expects the following arguments:</p><ul><li><em><strong>dimName</strong></em> - the dimension name, you can also use <em>dimName:hierName</em> syntax to specify an alternative hierarchy</li><li><em><strong>rangeElements</strong></em> - select the cells representing your elements</li><li><em><strong>attrName</strong></em> - attribute name, i.e. &#39;Caption&#39;</li><li><em><strong>options</strong></em> - flag, &quot;S&quot; - static values.</li><li><em><strong>solveOrder</strong></em> - specifies the formula evaluation order. If omitted, the default value of 0 will be used.</li></ul><p><img src="'+t+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1901571147" target="_blank" rel="noreferrer">=ATTR() formula example</a></p><h3 id="dimension-name" tabindex="-1">Dimension name <a class="header-anchor" href="#dimension-name" aria-label="Permalink to &quot;Dimension name&quot;">​</a></h3><p>To specify a dimension name, simply enter the name. Alternatively, you can use the syntax <em>dimName:hierName</em> to specify an alternative hierarchy.</p><h3 id="element-range" tabindex="-1">Element range <a class="header-anchor" href="#element-range" aria-label="Permalink to &quot;Element range&quot;">​</a></h3><p>Select cells in a spreadsheet, you can choose a single cell, or a range of multiple horizontal or vertical cells. TeamOne will ignore any empty cells that are included in the range.</p><p><img src="'+t+'" alt="img" data-zoomable=""></p><h2 id="subset-function" tabindex="-1">SUBSET() function <a class="header-anchor" href="#subset-function" aria-label="Permalink to &quot;SUBSET() function&quot;">​</a></h2><p><em><strong>SUBSET()</strong></em> function retrieves dimension elements using the provided set expression. It expects the following arguments:</p><ul><li><em><strong>dimName</strong></em> - the dimension name, you can also use <em>dimName:hierName</em> syntax to specify an alternative hierarchy</li><li><em><strong>setExpression</strong></em> - a valid MDX expression, $SubsetName or <a href="./functions.html#mdx-mods"><em><strong>MDX mods</strong></em></a></li><li><em><strong>attrName</strong></em> - attribute name, i.e. &#39;Caption&#39;</li><li><em><strong>options</strong></em> - flag, &quot;S&quot; - static values.</li><li><em><strong>solveOrder</strong></em> - specifies the formula evaluation order. If omitted, the default value of 0 will be used.</li></ul><p><img src="'+s+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=557987930" target="_blank" rel="noreferrer">=SUBSET() formula example</a></p><h3 id="set-expression" tabindex="-1">Set expression <a class="header-anchor" href="#set-expression" aria-label="Permalink to &quot;Set expression&quot;">​</a></h3><p>You can provide a valid MDX expression or use TeamOne subset syntax:</p><ul><li>a semicolon delimited element list, i.e.: <em>Jan;Feb;Mar</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/FY202? */</em></li><li>a subset name after a dollar character, i.e. <em>$My subset name</em></li><li>a subset <a href="./functions.html#subset-keywords">keyword</a>, i.e.: <em>$LEAVES</em> or <em>$ALL</em> or <em>$ROOTS</em></li></ul><p>You can also combine elements, patterns, MDX expressions, <a href="./functions.html#subset-keywords">subset keywords</a> and <a href="./functions.html#mdx-mods">MDX mods</a> into a semicolon delimited list, i.e.: <em>{[month].[Q1].children};/FY202*/&gt;&gt;sortasc</em></p><h2 id="username-function" tabindex="-1">USERNAME() function <a class="header-anchor" href="#username-function" aria-label="Permalink to &quot;USERNAME() function&quot;">​</a></h2><p><em><strong>USERNAME()</strong></em> function returns the current user name from the IBM Planning Analytics connection. This function has no arguments.</p><p><img src="'+q+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=1486768434" target="_blank" rel="noreferrer">=USERNAME() formula example</a></p><h2 id="updated-function" tabindex="-1">UPDATED() function <a class="header-anchor" href="#updated-function" aria-label="Permalink to &quot;UPDATED() function&quot;">​</a></h2><p><em><strong>UPDATED()</strong></em> function returns the date and time the current sheet data was refreshed from IBM Planning Analytics. This function has no arguments.</p><p><img src="'+x+'" alt="img" data-zoomable=""></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit?gid=1486768434" target="_blank" rel="noreferrer">=USERNAME() formula example</a></p>',106)]))}const D=i(E,[["render",w]]);export{O as __pageData,D as default};
