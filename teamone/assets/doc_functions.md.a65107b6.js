import{_ as n,c as l,o as s,a as e,b as t}from"./app.16ddff48.js";import{_ as i}from"./teamone_formula.685518ae.js";var o="/teamone/img/functions/teamone_formula.png",a="/teamone/img/functions/teamone_formula_insert.png",u="/teamone/img/functions/increase_indent.png",r="/teamone/img/functions/code_cube.png",d="/teamone/img/functions/code_view.png",c="/teamone/img/functions/code_view_subset_options.png";const ke='{"title":"Functions","description":"","frontmatter":{},"headers":[{"level":2,"title":"TEAMONE recalculate","slug":"teamone-recalculate"},{"level":3,"title":"STEP 1. Define a formula","slug":"step-1-define-a-formula"},{"level":3,"title":"STEP 2. Recalculate the values","slug":"step-2-recalculate-the-values"},{"level":3,"title":"Hints","slug":"hints"},{"level":2,"title":"Increase indent","slug":"increase-indent"},{"level":2,"title":"Decrease indent","slug":"decrease-indent"},{"level":2,"title":"Add code","slug":"add-code"},{"level":3,"title":"::cube","slug":"cube"},{"level":3,"title":"::view","slug":"view"},{"level":3,"title":"::dimension","slug":"dimension"},{"level":3,"title":"::subset","slug":"subset"},{"level":3,"title":"::cube.security","slug":"cube-security"},{"level":3,"title":"::dimension.security","slug":"dimension-security"},{"level":3,"title":"::element.security","slug":"element-security"},{"level":3,"title":"::application.security","slug":"application-security"},{"level":3,"title":"::process.security","slug":"process-security"},{"level":3,"title":"::prolog.code","slug":"prolog-code"},{"level":3,"title":"::epilog.code","slug":"epilog-code"},{"level":2,"title":"comments","slug":"comments"},{"level":2,"title":"Format code","slug":"format-code"},{"level":2,"title":"Run code","slug":"run-code"}],"relativePath":"doc/functions.md","lastUpdated":1642106059601}',m={},h=e("h1",{id:"functions",tabindex:"-1"},[t("Functions "),e("a",{class:"header-anchor",href:"#functions","aria-hidden":"true"},"#")],-1),p=e("p",null,[t("Functions tab extends sheets with TM1 specific functionality and all the actions will be performed on the "),e("strong",null,"current/active sheet")],-1),b=e("h2",{id:"teamone-recalculate",tabindex:"-1"},[t("TEAMONE recalculate "),e("a",{class:"header-anchor",href:"#teamone-recalculate","aria-hidden":"true"},"#")],-1),f=e("p",null,[t("Recalculates all "),e("em",null,[e("strong",null,"TEAMONE")]),t(" formulas on the current sheet. "),e("em",null,[e("strong",null,"TEAMONE")]),t(" formula allows to bring data from TM1 server directly to sheets in 2 steps")],-1),g=e("h3",{id:"step-1-define-a-formula",tabindex:"-1"},[t("STEP 1. Define a formula "),e("a",{class:"header-anchor",href:"#step-1-define-a-formula","aria-hidden":"true"},"#")],-1),y=e("p",null,"TEAMONE formula expects the next arguments:",-1),_=e("ul",null,[e("li",null,[e("em",null,[e("strong",null,"cube connection")]),t(' - "TM1 connection:cube name" string, where TM1 connection is one of the configurated connections. You can specify only the cube name to fetch data from the currently selected TM1 connection in TeamOne sidebar.')]),e("li",null,[e("em",null,[e("strong",null,"rangeRows")]),t(" - select the cells represeting your rows")]),e("li",null,[e("em",null,[e("strong",null,"rangeColumns")]),t(" - select the cells represeting your columns")]),e("li",null,[e("em",null,[e("strong",null,"rangeTitles")]),t(" - select the cells represeting your context elements For rows and columns you can select multiple cells, a single cell or even no cells, use an empty string or leave the argument empty:")])],-1),v=e("div",{class:"language-"},[e("pre",null,[e("code",null,`// Revenue cube in TM1QA environment
=TEAMONE('TM1QA:Revenue', A4:A5, B2:C3, A2:A3)

// No connection name. No rows (argument #2 is skipped). Hardcoded title
=TEAMONE('Revenue', , C1:F1, 'Gross Revenue')
`)])],-1),w=e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},"Range"),e("p",null,"A range should represent TM1 dimension element names or aliases. You can use 2 dimensional ranges for rows and columns (to use multiple cube dimensions), but titles range should only include either a single cell or a one dimensional range. You should specify at least 1 row or 1 column or 1 title range")],-1),x=e("p",null,[e("img",{src:i,alt:"img"})],-1),T=e("h3",{id:"step-2-recalculate-the-values",tabindex:"-1"},[t("STEP 2. Recalculate the values "),e("a",{class:"header-anchor",href:"#step-2-recalculate-the-values","aria-hidden":"true"},"#")],-1),A=e("p",null,[t("Go to "),e("em",null,"TeamOne sidebar > Functions"),t(" tab and click "),e("em",null,"TEAMONE recalculate"),t(". Depending on how many formulas you have on the current sheet and your TM1 model and data complexity, it may take a few seconds or much longer to fetch all the requested data.")],-1),E=e("h3",{id:"hints",tabindex:"-1"},[t("Hints "),e("a",{class:"header-anchor",href:"#hints","aria-hidden":"true"},"#")],-1),M=e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},"Dimensions and elements"),e("p",null,"You do not need to include elements for all the cube dimensions. TeamOne will select the default member for ech mitted dimensions.")],-1),C=e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},"Alternative hierarhies"),e("p",null,[t("For each first range element, you can specify the dimension and hierarchy using the next syntax: "),e("em",null,"dimension:hierarchy:element"),t(" This is also recomended for better performance and in case when you use element(s) with the same name existing in other dimensions")])],-1),O=e("p",null,[e("img",{src:o,alt:"img"})],-1),N=e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},"Autogenerate formula"),e("p",null,[t("You can easily autogenerate a formula using the cube/view menu button on the "),e("em",null,"Model"),t(" tab")])],-1),k=e("p",null,[e("img",{src:a,alt:"img"})],-1),D=e("h2",{id:"increase-indent",tabindex:"-1"},[t("Increase indent "),e("a",{class:"header-anchor",href:"#increase-indent","aria-hidden":"true"},"#")],-1),S=e("p",null,[t("Being a really great tool, sheets are missing 2 simple functions to increase and decrease cell indentation. "),e("strong",null,"Increase indent"),t(" adds 1 space (on the left) to the selected cells. "),e("img",{src:u,alt:"img"})],-1),I=e("h2",{id:"decrease-indent",tabindex:"-1"},[t("Decrease indent "),e("a",{class:"header-anchor",href:"#decrease-indent","aria-hidden":"true"},"#")],-1),R=e("p",null,[t("Opposite to the function above, "),e("strong",null,"Decrease indent"),t(" trims 1 space (from the left) of the selected cells.")],-1),L=e("h2",{id:"add-code",tabindex:"-1"},[t("Add code "),e("a",{class:"header-anchor",href:"#add-code","aria-hidden":"true"},"#")],-1),B=e("p",null,[t("Though PAW provides a web interface to do TM1 modeling, it is still very tedious to develop and update your models, document your changes and deploy them to other environments. "),e("strong",null,"TeamOne"),t(" allows to create/update tm1 cubes, views, dimensions, hierarchies, subsets, elements, attributes, manage users, groups, permissions, object security... without a single line of code. It is like you use Sheets to write a documentation and the documentation is used to update your model automatically. Moreover:")],-1),P=e("ul",null,[e("li",null,"you can collaborate with all your team members when you have new TM1 requirements or change requests"),e("li",null,"a model draft gathered during reqruiements discussions can replace up to 95% of the development"),e("li",null,"you can have maximum involvement of analysts and business users, for instance, you can ask somebody to translate element captions to a different language and then you will be only one click to get the new localized captions syncronized in TM1."),e("li",null,"your documentation is created before the development has even started, moreover, it gets updated as soon as you change anything"),e("li",null,"you can prototype and implement real models in seconds")],-1),F=e("p",null,[e("em",null,[e("strong",null,"Add code")]),t(" will open an interface where you can add a template to:")],-1),Y=e("ul",null,[e("li",null,"Create/update cube"),e("li",null,"Create/update view"),e("li",null,"Create/update dimension hierarchy"),e("li",null,"Create/update subset"),e("li",null,"Manage cube security"),e("li",null,"Manage dimension security"),e("li",null,"Manage element security"),e("li",null,"Manage application security"),e("li",null,"Manage process security"),e("li",null,"Add prolog code"),e("li",null,"Add epilog code")],-1),U=e("p",null,[t("You fill out the basic template form and click "),e("em",null,"ADD TO ACTIVE SHEET"),t(" button, where you will be able add more fields and customize the code block. Once done, you can "),e("a",{href:"#format-code"},"format"),t(" and "),e("a",{href:"#run-code"},"run"),t(" code.")],-1),V=e("h3",{id:"cube",tabindex:"-1"},[t("::cube "),e("a",{class:"header-anchor",href:"#cube","aria-hidden":"true"},"#")],-1),z=e("p",null,[t("Use a "),e("strong",null,"::cube"),t(" block to create and update cubes. You specify the cube name in the second column See a "),e("a",{href:"https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=96363892",target:"_blank",rel:"noopener noreferrer"},"::cube example")],-1),Q=e("table",null,[e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"left"}},"Option / parameter"),e("th",null,"Description")])]),e("tbody",null,[e("tr",null,[e("td",{style:{"text-align":"left"}},"-recreate"),e("td",null,"Include this option if you want to recreate cube, you don't need to specidy any value. This option is mainly used in the dev environment when you need to change cube dimensions. IMPORTANT: recreating the cube will also delete all cube data.")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-caption"),e("td",null,[t("Allows to specify a cube caption. You can localize the cube name by adding multiple caption options in a format "),e("em",null,[e("strong",null,"-caption:locale")]),t(", for instance "),e("em",null,"-captions:en"),t(", "),e("em",null,"-caption:fr"),t(", etc. The locale should exist in "),e("strong",null,"}Cultures"),t(" dimension.")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"Dimension 1-N"),e("td",null,"Use a separate row to specify the needed cube dimension names in the order you want them to be in the cube. Remember you can have up to 256 dimensions in TM1 cube.")])])],-1),X=e("p",null,[t("In the next example let's create "),e("em",null,[e("strong",null,"XR")]),t(" cube that consists if 3 dimensions. We will also add "),e("em",null,"Exchange Rates"),t(" caption. Later we can add other localized captions: "),e("img",{src:r,alt:"img"})],-1),H=e("h3",{id:"view",tabindex:"-1"},[t("::view "),e("a",{class:"header-anchor",href:"#view","aria-hidden":"true"},"#")],-1),W=e("p",null,[t("Use a "),e("strong",null,"::view"),t(" block to create and update a cube view. You specify the view name in the second column See a "),e("a",{href:"https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1467356606",target:"_blank",rel:"noopener noreferrer"},":: view example")],-1),j=e("table",null,[e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"left"}},"Option / parameter"),e("th",null,"Description")])]),e("tbody",null,[e("tr",null,[e("td",{style:{"text-align":"left"}},"-cube"),e("td",null,"cube name")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-subset"),e("td",null,[t("default subset in a format "),e("em",null,"@SubsetName"),t(", will be used for all the ommited dimensions. "),e("em",null,"@ALL"),t(" subset will be used if this option is omitted")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-alias"),e("td",null,"default subset alias, if exists the alias will be applied to each created subset. If subset already exists, its current alias will not be updated")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-recreate"),e("td",null,[t("recreate default subset, it is used with the "),e("em",null,"-subset"),t(" option above. For instance, you specify "),e("em",null,"-subset"),t(" option as '@leaves'. Then it will recreate the "),e("em",null,"LEAVES"),t(" subset for each dimension you omitted in the current view definition")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"Dimension 1-N"),e("td",null,[t("enter a dimension name in "),e("em",null,"column A"),t(", subset\\expression in "),e("em",null,"column B"),t(" and subset options in "),e("em",null,"column C"),t(". Use the next syntax to set a view row or column dimension: "),e("strong",null,"R:dimensionName"),t(", "),e("strong",null,"C:dimensionName"),t(". See below how to define elements\\subset\\mdx for each dimension subset in column B")])])])],-1),$=e("p",null,[t("In "),e("em",null,"column B"),t(" for each dimension you can define a subset or MDX expressions as:")],-1),q=e("ul",null,[e("li",null,[t("a comma delimited element list, i.e.: "),e("em",null,"Actual,Budget, Forecast")]),e("li",null,[t("an existing subset name in a format "),e("strong",null,"@SubsetName")]),e("li",null,[e("em",null,"@ALL, @LEAVES and @ROOTS"),t(" system subsets. TeamOne will create a system subset if it does not exist using the next MDX expressions: "),e("ul",null,[e("li",null,[e("strong",null,"ALL"),t(": {HIERARCHIZE({[dimensionName].members})}")]),e("li",null,[e("strong",null,"LEAVES"),t(": {TM1FILTERBYLEVEL( {[dimensionName].members}, 0)}")]),e("li",null,[e("strong",null,"ROOTS"),t(': {FILTER( {[dimensionName].members}, [dimensionName].CurrentMember.Parent.Name = "")}')])])]),e("li",null,[t("a valid MDX expression, i.e.: "),e("em",null,"{[Calendar]}.[2022].Children}")]),e("li",null,[t('a pattern using "*" for any characters and "?" for any one character, i.e.: '),e("em",null,"/*substring*/"),t(" or "),e("em",null,"/2022 Q?/"),t(" You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: "),e("em",null,"Current period,Previous period,{[Calendar]}.[2022].Children,/2022 Q?/"),t(" If you leave Column B value empty, the "),e("em",null,"-subset"),t(" option will be used")])],-1),G=e("p",null,[e("img",{src:d,alt:"img"})],-1),Z=e("p",null,[t("In "),e("em",null,"column C"),t(" you can enter subset options in the next format: '-name:Total Company -alias:Caption_Base', which will name the subset as "),e("em",null,"Total Company"),t(" and will set the "),e("em",null,"Caption_Base"),t(" alias. See more "),e("a",{href:"#subset"},"subset options"),t(" below")],-1),K=e("p",null,[e("img",{src:c,alt:"img"})],-1),J=e("h3",{id:"dimension",tabindex:"-1"},[t("::dimension "),e("a",{class:"header-anchor",href:"#dimension","aria-hidden":"true"},"#")],-1),ee=e("p",null,[t("Use a "),e("strong",null,"::dimension"),t(" block to create and update dimensions. You specify the dimension name in the second column")],-1),te=e("table",null,[e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"left"}},"Option / parameter"),e("th",null,"Description")])]),e("tbody",null,[e("tr",null,[e("td",{style:{"text-align":"left"}},"-hierarchy"),e("td",null,"If this option is specified, it will create an alternative hierarchy, if omitted the default hiearchy will be created")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-recreate"),e("td",null,"Include this option if you want to recreate the cube, you don't need to specidy any value. This option is mainly used in the dev environment when you need to change cube dimensions. IMPORTANT: this option will delete all the cube data.")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-caption"),e("td",null,[t("Allows to specify a dimension caption. You can localize the dimension name by adding multiple caption options in a format "),e("em",null,[e("strong",null,"-caption:locale")]),t(", for instance "),e("em",null,"-captions:en"),t(", "),e("em",null,"-caption:fr"),t(", etc. The locale should exist in "),e("strong",null,"}Cultures"),t(" dimension.")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"Element 1-N"),e("td",null,[t("Use a separate row to specify the dimension element names in the order you want them to be in the dimension. There are 2 ways to organize elements into a parent-child hierarchy: you can eiher use a space indentation in "),e("em",null,"column A"),t(" or you can specify the parent element in "),e("em",null,"column B")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-subset"),e("td",null,"Will create the Default and system subsets (ALL, LEAVES, ROOTS). The value in Column B will be used as a default subset expression. @leaves will be used if omitted.")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-subset.leaves"),e("td",null,[t("Will create "),e("em",null,"LEAVES"),t(" subset. The value in Column B will be used as a subset expression. @leaves subset will be used if omitted.")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-subset.all"),e("td",null,[t("Will create "),e("em",null,"ALL"),t(" subset. The value in Column B will be used as a subset expression. @all subset will be used if omitted.")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-subset.roots"),e("td",null,[t("Will create "),e("em",null,"ROOTS"),t(" subset. The value in Column B will be used as a subset expression. @roots subset will be used if omitted.")])])])],-1),ne=e("p",null,[t("For instance let's create a Period dimension containing 2021 and 2022 months. Let's also add "),e("strong",null,"en"),t(" and "),e("strong",null,"fr"),t(" localized captions. Also let's create the default and system subset:")],-1),le=e("h3",{id:"subset",tabindex:"-1"},[t("::subset "),e("a",{class:"header-anchor",href:"#subset","aria-hidden":"true"},"#")],-1),se=e("p",null,[t("Use a "),e("strong",null,"::subset"),t(" block to create and update subsets. You specify the subset name in the second column")],-1),ie=e("table",null,[e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"left"}},"Option / parameter"),e("th",null,"Description")])]),e("tbody",null,[e("tr",null,[e("td",{style:{"text-align":"left"}},"-dimension"),e("td",null,"Dimension to create a subset for")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-hierarchy"),e("td",null,"Use this option to specify which hiearchy to create a subset in. If omitted the default hiearchy will be used")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-alias"),e("td",null,"Used to specify a subset alias")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-expandabove"),e("td",null,[t("Use this option to set the subset expand above flag. Use "),e("em",null,"False"),t(" value to disable it if needed")])]),e("tr",null,[e("td",{style:{"text-align":"left"}},"-dynamic"),e("td",null,"Include this option if you want to recreate a dynamic subset")]),e("tr",null,[e("td",{style:{"text-align":"left"}},"Element 1-N"),e("td",null,"Use a separate row to specify the elements to include in the subset. See below how to define subset elements\\mdx for each")])])],-1),oe=e("p",null,"In Column A on each row you can specify:",-1),ae=e("ul",null,[e("li",null,"an element name"),e("li",null,[t("a comma delimited element list, i.e.: "),e("em",null,"Actual,Budget, Forecast")]),e("li",null,[t("a valid MDX expression, i.e.: "),e("em",null,"{[Calendar]}.[2022].Children}")]),e("li",null,[t('a pattern using "*" (any characters) and "?" (any one character), i.e.: '),e("em",null,"/*substring*/"),t(" or "),e("em",null,"/2022 Q?/"),t(" You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: "),e("em",null,"Current period,Previous period,{[Calendar]}.[2022].Children,/2022 Q?/")])],-1),ue=e("p",null,[t("For instance let's create a Period dimension containing 2021 and 2022 months. Let's also add "),e("strong",null,"en"),t(" and "),e("strong",null,"fr"),t(" localized captions. Also let's create the default and system subset:")],-1),re=e("h3",{id:"cube-security",tabindex:"-1"},[t("::cube.security "),e("a",{class:"header-anchor",href:"#cube-security","aria-hidden":"true"},"#")],-1),de=e("h3",{id:"dimension-security",tabindex:"-1"},[t("::dimension.security "),e("a",{class:"header-anchor",href:"#dimension-security","aria-hidden":"true"},"#")],-1),ce=e("h3",{id:"element-security",tabindex:"-1"},[t("::element.security "),e("a",{class:"header-anchor",href:"#element-security","aria-hidden":"true"},"#")],-1),me=e("h3",{id:"application-security",tabindex:"-1"},[t("::application.security "),e("a",{class:"header-anchor",href:"#application-security","aria-hidden":"true"},"#")],-1),he=e("h3",{id:"process-security",tabindex:"-1"},[t("::process.security "),e("a",{class:"header-anchor",href:"#process-security","aria-hidden":"true"},"#")],-1),pe=e("h3",{id:"prolog-code",tabindex:"-1"},[t("::prolog.code "),e("a",{class:"header-anchor",href:"#prolog-code","aria-hidden":"true"},"#")],-1),be=e("h3",{id:"epilog-code",tabindex:"-1"},[t("::epilog.code "),e("a",{class:"header-anchor",href:"#epilog-code","aria-hidden":"true"},"#")],-1),fe=e("h2",{id:"comments",tabindex:"-1"},[t("comments "),e("a",{class:"header-anchor",href:"#comments","aria-hidden":"true"},"#")],-1),ge=e("h2",{id:"format-code",tabindex:"-1"},[t("Format code "),e("a",{class:"header-anchor",href:"#format-code","aria-hidden":"true"},"#")],-1),ye=e("p",null,"It will format",-1),_e=e("h2",{id:"run-code",tabindex:"-1"},[t("Run code "),e("a",{class:"header-anchor",href:"#run-code","aria-hidden":"true"},"#")],-1),ve=[h,p,b,f,g,y,_,v,w,x,T,A,E,M,C,O,N,k,D,S,I,R,L,B,P,F,Y,U,V,z,Q,X,H,W,j,$,q,G,Z,K,J,ee,te,ne,le,se,ie,oe,ae,ue,re,de,ce,me,he,pe,be,fe,ge,ye,_e];function we(xe,Te,Ae,Ee,Me,Ce){return s(),l("div",null,ve)}var De=n(m,[["render",we]]);export{ke as __pageData,De as default};
