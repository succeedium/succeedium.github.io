<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Functions |  </title>
    <meta name="description" content="TeamOne IBM Planning Analytics add-on for Google Sheets">
    <link rel="stylesheet" href="/teamone/assets/style.81802afb.css">
    <link rel="modulepreload" href="/teamone/assets/Home.7857d163.js">
    <link rel="modulepreload" href="/teamone/assets/AlgoliaSearchBox.ab127a42.js">
    <link rel="modulepreload" href="/teamone/assets/app.7bb46320.js">
    <link rel="modulepreload" href="/teamone/assets/teamone_formula.685518ae.js">
    <link rel="modulepreload" href="/teamone/assets/doc_functions.md.b06ed801.lean.js">
    <link rel="modulepreload" href="/teamone/assets/app.7bb46320.js">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-KB4H08LH1S"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KB4H08LH1S');</script>
    <meta name="twitter:title" content="Functions |  ">
    <meta property="og:title" content="Functions |  ">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/teamone/" aria-label=" , back to home" data-v-675d8756 data-v-4a583abe><img class="logo" src="/teamone/img/home/logo.png" alt="Logo" data-v-4a583abe>  </a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/" data-v-b8818f8c>About <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/doc/" data-v-b8818f8c>Doc <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://succeedium.com/teamone/pricing.html" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Pricing <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/faq" data-v-b8818f8c>FAQ <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/contact" data-v-b8818f8c>Contact <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/" data-v-b8818f8c>About <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/doc/" data-v-b8818f8c>Doc <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://succeedium.com/teamone/pricing.html" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>Pricing <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/faq" data-v-b8818f8c>FAQ <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/teamone/contact" data-v-b8818f8c>Contact <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item"></p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/teamone/doc/">Getting started</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/teamone/doc/functions">Functions</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#teamone-recalculate">TEAMONE recalculate</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#step-1-define-a-formula">STEP 1. Define a formula</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#step-2-recalculate-the-values">STEP 2. Recalculate the values</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#hints">Hints</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#increase-indent">Increase indent</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#decrease-indent">Decrease indent</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#add-code">Add code</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#cube">::cube</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#view">::view</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dimension">::dimension</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#subset">::subset</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#element-security">::element.security</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#dimension-security">::dimension.security</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#cube-security">::cube.security</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#application-security">::application.security</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#process-security">::process.security</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#prolog-code">::prolog.code</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#epilog-code">::epilog.code</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#comments">comments</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#format-code">Format code</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#run-code">Run code</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/teamone/doc/tasks">Tasks</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/teamone/doc/model">Model</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/teamone/doc/users">Users</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/teamone/doc/issues">Issues</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-hidden="true">#</a></h1><p>Functions tab extends sheets with TM1 specific functionality and all the actions will be performed on the <strong>current/active sheet</strong></p><h2 id="teamone-recalculate" tabindex="-1">TEAMONE recalculate <a class="header-anchor" href="#teamone-recalculate" aria-hidden="true">#</a></h2><p>Recalculates all <em><strong>TEAMONE</strong></em> formulas on the current sheet. <em><strong>TEAMONE</strong></em> formula allows to bring data from TM1 server directly to sheets in 2 steps</p><h3 id="step-1-define-a-formula" tabindex="-1">STEP 1. Define a formula <a class="header-anchor" href="#step-1-define-a-formula" aria-hidden="true">#</a></h3><p>TEAMONE formula expects the next arguments:</p><ul><li><em><strong>cube connection</strong></em> - &quot;TM1 connection:cube name&quot; string, where TM1 connection is one of the configurated connections. You can specify only the cube name to fetch data from the currently selected TM1 connection in TeamOne sidebar.</li><li><em><strong>rangeRows</strong></em> - select the cells represeting your rows</li><li><em><strong>rangeColumns</strong></em> - select the cells represeting your columns</li><li><em><strong>rangeTitles</strong></em> - select the cells represeting your context elements For rows and columns you can select multiple cells, a single cell or even no cells, use an empty string or leave the argument empty:</li></ul><div class="language-"><pre><code>// Revenue cube in TM1QA environment
=TEAMONE(&#39;TM1QA:Revenue&#39;, A4:A5, B2:C3, A2:A3)

// No connection name. No rows (argument #2 is skipped). Hardcoded title
=TEAMONE(&#39;Revenue&#39;, , C1:F1, &#39;Gross Revenue&#39;)
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Range</p><p>A range should represent TM1 dimension element names or aliases. You can use 2 dimensional ranges for rows and columns (to use multiple cube dimensions), but titles range should only include either a single cell or a one dimensional range. You should specify at least 1 row or 1 column or 1 title range</p></div><div class="tip custom-block"><p class="custom-block-title">Repetitive elements</p><p>If you have multiple rows and/or columns, you don&#39;t have to specify repetitive elements for each row or column. TeamOne will automatically use the same element name if the next rows/columns are blank</p></div><p><img src="/teamone/img/home/teamone_formula.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=0" target="_blank" rel="noopener noreferrer">::TEAMONE formula example</a></p><h3 id="step-2-recalculate-the-values" tabindex="-1">STEP 2. Recalculate the values <a class="header-anchor" href="#step-2-recalculate-the-values" aria-hidden="true">#</a></h3><p>Go to <em>TeamOne sidebar &gt; Functions</em> tab and click <em>TEAMONE recalculate</em>. Depending on how many formulas you have on the current sheet and your TM1 model and data complexity, it may take a few seconds or much longer to fetch all the requested data.</p><h3 id="hints" tabindex="-1">Hints <a class="header-anchor" href="#hints" aria-hidden="true">#</a></h3><div class="tip custom-block"><p class="custom-block-title">Dimensions and elements</p><p>You do not need to include elements for all the cube dimensions. TeamOne will select the default member for ech mitted dimensions.</p></div><div class="tip custom-block"><p class="custom-block-title">Alternative hierarhies</p><p>For each first range element, you can specify the dimension and hierarchy using the next syntax: <em>dimension:hierarchy:element</em> This is also recomended for better performance and in case when you use element(s) with the same name existing in other dimensions</p></div><p><img src="/teamone/img/functions/teamone_formula.png" alt="img"></p><div class="tip custom-block"><p class="custom-block-title">Autogenerate formula</p><p>You can easily autogenerate a formula using the cube/view menu button on the <em>Model</em> tab</p></div><p><img src="/teamone/img/functions/teamone_formula_insert.png" alt="img"></p><h2 id="increase-indent" tabindex="-1">Increase indent <a class="header-anchor" href="#increase-indent" aria-hidden="true">#</a></h2><p>Being a really great tool, sheets are missing 2 simple functions to increase and decrease cell indentation. <strong>Increase indent</strong> adds 1 space (on the left) to the selected cells. <img src="/teamone/img/functions/increase_indent.png" alt="img"></p><h2 id="decrease-indent" tabindex="-1">Decrease indent <a class="header-anchor" href="#decrease-indent" aria-hidden="true">#</a></h2><p>Opposite to the function above, <strong>Decrease indent</strong> trims 1 space (from the left) of the selected cells.</p><h2 id="add-code" tabindex="-1">Add code <a class="header-anchor" href="#add-code" aria-hidden="true">#</a></h2><p>Though PAW provides a web interface to do TM1 modeling, it is still very tedious to develop and update your models, document your changes and deploy them to other environments. <strong>TeamOne</strong> allows to create/update tm1 cubes, views, dimensions, hierarchies, subsets, elements, attributes, manage users, groups, permissions, object security... without a single line of code. It is like you use Sheets to write a documentation and the documentation is used to update your model automatically. Moreover:</p><ul><li>you can collaborate with all your team members when you have new TM1 requirements or change requests</li><li>a model draft gathered during reqruiements discussions can replace up to 95% of the development</li><li>you can have maximum involvement of analysts and business users, for instance, you can ask somebody to translate element captions to a different language and then you will be only one click to get the new localized captions syncronized in TM1.</li><li>your documentation is created before the development has even started, moreover, it gets updated as soon as you change anything</li><li>you can prototype and implement real models in seconds</li></ul><p><em><strong>Add code</strong></em> will open an interface where you can add a template to:</p><ul><li>Create/update cube</li><li>Create/update view</li><li>Create/update dimension hierarchy</li><li>Create/update subset</li><li>Manage cube security</li><li>Manage dimension security</li><li>Manage element security</li><li>Manage application security</li><li>Manage process security</li><li>Add prolog code</li><li>Add epilog code</li></ul><p>You fill out the basic template form and click <em>ADD TO ACTIVE SHEET</em> button, where you will be able add more fields and customize the code block. Once done, you can <a href="#format-code">format</a> and <a href="#run-code">run</a> code.</p><h3 id="cube" tabindex="-1">::cube <a class="header-anchor" href="#cube" aria-hidden="true">#</a></h3><p>Use <strong>::cube</strong> block to create and update cubes. You specify the cube name in the second column</p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Include this option if you want to recreate cube, you don&#39;t need to specidy any value. This option is mainly used in the dev environment when you need to change cube dimensions. IMPORTANT: recreating the cube will also delete all cube data.</td></tr><tr><td style="text-align:left;">-caption</td><td>Allows to specify a cube caption. You can localize the cube name by adding multiple caption options in a format <em><strong>-caption:locale</strong></em>, for instance <em>-captions:en</em>, <em>-caption:fr</em>, etc. The locale should exist in <strong>}Cultures</strong> dimension.</td></tr><tr><td style="text-align:left;">Dimension 1-N</td><td>Use a separate row to specify the needed cube dimension names in the order you want them to be in the cube. Remember you can have up to 256 dimensions in TM1 cube.</td></tr></tbody></table><p>In the next example let&#39;s create <em><strong>XR</strong></em> cube that consists if 3 dimensions. We will also add <em>Exchange Rates</em> caption. Later we can add other localized captions: <img src="/teamone/img/functions/code_cube.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=96363892" target="_blank" rel="noopener noreferrer">::cube example</a></p><h3 id="view" tabindex="-1">::view <a class="header-anchor" href="#view" aria-hidden="true">#</a></h3><p>Use <strong>::view</strong> block to create and update a cube view. You specify the view name in the second column</p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-cube</td><td>cube name</td></tr><tr><td style="text-align:left;">-subset</td><td>default subset in a format <em>@SubsetName</em>, will be used for all the ommited dimensions. <em>@ALL</em> subset will be used if this option is omitted</td></tr><tr><td style="text-align:left;">-alias</td><td>default subset alias, if exists the alias will be applied to each created subset. If subset already exists, its current alias will not be updated</td></tr><tr><td style="text-align:left;">-recreate</td><td>recreate default subset, it is used with the <em>-subset</em> option above. For instance, you specify <em>-subset</em> option as &#39;@leaves&#39;. Then it will recreate the <em>LEAVES</em> subset for each dimension you omitted in the current view definition</td></tr><tr><td style="text-align:left;">Dimension 1-N</td><td>enter a dimension name in <em>column A</em>, subset\expression in <em>column B</em> and subset options in <em>column C</em>. Use the next syntax to set a view row or column dimension: <strong>R:dimensionName</strong>, <strong>C:dimensionName</strong>. See below how to define elements\subset\mdx for each dimension subset in column B</td></tr></tbody></table><p>In <em>column B</em> for each dimension you can define a subset or MDX expressions as:</p><ul><li>a comma delimited element list, i.e.: <em>Actual,Budget, Forecast</em></li><li>an existing subset name in a format <strong>@SubsetName</strong></li><li><em>@ALL, @LEAVES and @ROOTS</em> system subsets. TeamOne will create a system subset if it does not exist using the next MDX expressions: <ul><li><strong>ALL</strong>: {HIERARCHIZE({[dimensionName].members})}</li><li><strong>LEAVES</strong>: {TM1FILTERBYLEVEL( {[dimensionName].members}, 0)}</li><li><strong>ROOTS</strong>: {FILTER( {[dimensionName].members}, [dimensionName].CurrentMember.Parent.Name = &quot;&quot;)}</li></ul></li><li>a valid MDX expression, i.e.: <em>{[Calendar]}.[2022].Children}</em></li><li>a pattern using &quot;*&quot; for any characters and &quot;?&quot; for any one character, i.e.: <em>/*substring*/</em> or <em>/2022 Q?/</em> You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Current period,Previous period,{[Calendar]}.[2022].Children,/2022 Q?/</em> If you leave Column B value empty, the <em>-subset</em> option will be used</li></ul><p><img src="/teamone/img/functions/code_view.png" alt="img"></p><p>In <em>column C</em> you can enter subset options in the next format: &#39;-name:Total Company -alias:Caption_Base&#39;, which will name the subset as <em>Total Company</em> and will set the <em>Caption_Base</em> alias. See more <a href="#subset">subset options</a> below</p><p><img src="/teamone/img/functions/code_view_subset_options.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1467356606" target="_blank" rel="noopener noreferrer">::view example</a></p><h3 id="dimension" tabindex="-1">::dimension <a class="header-anchor" href="#dimension" aria-hidden="true">#</a></h3><p>Use <strong>::dimension</strong> block to create and update dimensions. You specify the dimension name in the second column. Starting from column 3 you can specify element attributes in a format: <em>AttributeName:AttributeType:AttributeLocale</em>, where <em>AttributeType</em> is one of the following:</p><ul><li><strong>S</strong> (default) - string</li><li><strong>A</strong> (default) - alias</li><li><strong>N</strong> (default) - numeric</li></ul><p><em>AttributeLocale</em> is an element in <strong>}Cultures</strong> dimension.</p><p>You can ommit <em>AttributeType</em> and/or <em>AttributeLocale</em>, a string non-localized attribute will be used, for example. let&#39;s create <strong>Caption</strong> alias, <strong>MonthNumber</strong> numeric and <strong>MonthName</strong> string attributes: <img src="/teamone/img/functions/code_element_attributes.png" alt="img"></p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-hierarchy</td><td>If this option is specified, it will create an alternative hierarchy, if omitted the default hiearchy will be created</td></tr><tr><td style="text-align:left;">-recreate</td><td>Include this option if you want to recreate the cube, you don&#39;t need to specidy any value. This option is mainly used in the dev environment when you need to change cube dimensions. IMPORTANT: this option will delete all the cube data.</td></tr><tr><td style="text-align:left;">-caption</td><td>Allows to specify a dimension caption. You can localize the dimension name by adding multiple caption options in a format <em><strong>-caption:locale</strong></em>, for instance <em>-captions:en</em>, <em>-caption:fr</em>, etc. The locale should exist in <strong>}Cultures</strong> dimension.</td></tr><tr><td style="text-align:left;">-subset</td><td>Will create the Default and system subsets (ALL, LEAVES, ROOTS). The value in Column B will be used as a default subset expression. @leaves will be used if omitted.</td></tr><tr><td style="text-align:left;">-subset.leaves</td><td>Will create <em>LEAVES</em> subset. The value in Column B will be used as a subset expression. @leaves subset will be used if omitted.</td></tr><tr><td style="text-align:left;">-subset.all</td><td>Will create <em>ALL</em> subset. The value in Column B will be used as a subset expression. @all subset will be used if omitted.</td></tr><tr><td style="text-align:left;">-subset.roots</td><td>Will create <em>ROOTS</em> subset. The value in Column B will be used as a subset expression. @roots subset will be used if omitted.</td></tr><tr><td style="text-align:left;">Element 1-N</td><td>Use a separate row to specify the dimension element names in the order you want them to be in the dimension. There are 2 ways to organize elements into a parent-child hierarchy: you can eiher use a space indentation in <em>column A</em> or you can specify the parent element in <em>column B</em>. If defined above, you can specify the element attribute values in the corresponding columns</td></tr></tbody></table><p>For instance let&#39;s create <strong>Period</strong> dimension containing 2022 and 2023 months. Let&#39;s also add <strong>en</strong> and <strong>fr</strong> localized captions. Also let&#39;s create the default and system subset: <img src="/teamone/img/functions/code_dimension.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=88848437" target="_blank" rel="noopener noreferrer">::dimension example</a></p><p>We can quickly add a <em><strong>Fiscal Quarter</strong></em> alternative hierarchy <img src="/teamone/img/functions/code_hierarchy.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=416332645" target="_blank" rel="noopener noreferrer">::hierarchy example</a></p><h3 id="subset" tabindex="-1">::subset <a class="header-anchor" href="#subset" aria-hidden="true">#</a></h3><p>Use <strong>::subset</strong> block to create and update subsets. You specify the subset name in the second column</p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-dimension</td><td>Dimension to create a subset for</td></tr><tr><td style="text-align:left;">-hierarchy</td><td>Use this option to specify which hiearchy to create a subset in. If omitted the default hiearchy will be used</td></tr><tr><td style="text-align:left;">-alias</td><td>Used to specify a subset alias</td></tr><tr><td style="text-align:left;">-expandabove</td><td>Use this option to set the subset expand above flag. Use <em>False</em> value to disable it if needed</td></tr><tr><td style="text-align:left;">-dynamic</td><td>Include this option if you want to recreate a dynamic subset</td></tr><tr><td style="text-align:left;">Element 1-N</td><td>Use a separate row to specify the elements to include in the subset. See below how to define subset elements\mdx for each</td></tr></tbody></table><p>In Column A on each row you can specify:</p><ul><li>an element name</li><li>a comma delimited element list, i.e.: <em>Actual,Budget, Forecast</em></li><li>a valid MDX expression, i.e.: <em>{[Calendar]}.[2022].Children}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/2022 Q?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Current period,Previous period,{[Calendar]}.[2022].Children,/2022 Q?/</em></p><p>For instance let&#39;s create a few subsets for the Period dimension: (<a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=416332645" target="_blank" rel="noopener noreferrer">https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=416332645</a>) <img src="/teamone/img/functions/code_subset.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=771454322" target="_blank" rel="noopener noreferrer">::subset example</a></p><h3 id="element-security" tabindex="-1">::element.security <a class="header-anchor" href="#element-security" aria-hidden="true">#</a></h3><p>Use <strong>::element.security</strong> block to define element security</p><p>You specify groups definitions starting from column 3. In each column you can use:</p><ul><li>a subset name in a format: <em>@SubsetName</em></li><li>a single group name</li><li>a comma delimited group list, i.e.: <em>Group 1, Group 2, Group 3</em></li><li>a valid MDX expression, i.e.: <em>{[}Groups].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Sec*Level?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Managers,Deputy,/Sec*Level?/</em></p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Wipe all security first</td></tr><tr><td style="text-align:left;">-createGroups</td><td>Include this option if you want to create non-existing security groups</td></tr><tr><td style="text-align:left;">-dimension</td><td>Dimension name (mandatory)</td></tr><tr><td style="text-align:left;">-hiearchy</td><td>Hierarchy name (optional), if omitted, the default hierarchy will be used</td></tr><tr><td style="text-align:left;">Element 1-N</td><td>Use a separate row to specify dimension elements, see below for syntax. Starting from column 3 (under the corresponding group definition), you can specify the security privileges, which could be on of the following: NONE, READ, WRITE, RESERVE, ADMIN, LOCK. If ommited, the default NONE privilege will be set</td></tr></tbody></table><p><em><strong>Element 1-N</strong></em> syntax:</p><ul><li>an element name</li><li>a comma delimited element list, i.e.: <em>FY2022 Jan,FY2022 Feb,FY2022 Mar</em></li><li>a valid MDX expression, i.e.: <em>{[Period].[Fiscal Quarter].[FY2022 Q1].children}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/FY202? */</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>FY2022 Jan,FY2022 Feb,FY2022 Mae,/FY2021*/</em></p><p><img src="/teamone/img/functions/code_element_security.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1nyqQf4YINYx-4jXYVi3Py6wRRhVZuHgv_ulcT9s-IoM/edit?pli=1#gid=1022680199" target="_blank" rel="noopener noreferrer">::element.security example</a></p><h3 id="dimension-security" tabindex="-1">::dimension.security <a class="header-anchor" href="#dimension-security" aria-hidden="true">#</a></h3><p>Use <strong>::dimension.security</strong> block to define dimension and hiearchy security (hiearchy security was introduced in <a href="https://www.ibm.com/support/pages/changes-hierarchy-security-ibm-planning-analytics-2095" target="_blank" rel="noopener noreferrer">IBM Planning Analytics 2.0.9.5</a>)</p><p>You specify groups definitions starting from column 3. In each column you can use:</p><ul><li>a subset name in a format: <em>@SubsetName</em></li><li>a single group name</li><li>a comma delimited group list, i.e.: <em>Group 1, Group 2, Group 3</em></li><li>a valid MDX expression, i.e.: <em>{[}Groups].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Sec*Level?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Managers,Deputy,/Sec*Level?/</em></p><p>Patterns make it super easy to setup security for alternate hierarchies, for instance: <em>/Product:/</em> will set the security for all the hierarchies of the <em>Product</em> dimension</p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Wipe all security first</td></tr><tr><td style="text-align:left;">-createGroups</td><td>Include this option if you want to create non-existing security groups</td></tr><tr><td style="text-align:left;">Dimension/hiearchy 1-N</td><td>Use a separate row to specify dimensions and hierarchies (in a format <em>dimension:hiearchy</em>), see below for syntax. Starting from column 3 (under the corresponding group definition), you can specify the security privileges, which could be on of the following: NONE, READ. If ommited, the default NONE privilege will be set</td></tr></tbody></table><p><em><strong>Dimension 1-N</strong></em> syntax:</p><ul><li>a dimension name</li><li>a comma delimited dimension list, i.e.: <em>Calendar:Fiscal Year,Employee,Job Type Assumption</em></li><li>a valid MDX expression, i.e.: <em>{[}Dimensions].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Revenu?ðŸ˜—/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Revenue,Employee,/*assumption*/</em></p><p><img src="/teamone/img/functions/code_dimension_security.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1309406887" target="_blank" rel="noopener noreferrer">::dimension.security example</a></p><h3 id="cube-security" tabindex="-1">::cube.security <a class="header-anchor" href="#cube-security" aria-hidden="true">#</a></h3><p>Use <strong>::cube.security</strong> block to define cube security</p><p>You specify groups definitions starting from column 3. In each column you can use:</p><ul><li>a subset name in a format: <em>@SubsetName</em></li><li>a single group name</li><li>a comma delimited group list, i.e.: <em>Group 1, Group 2, Group 3</em></li><li>a valid MDX expression, i.e.: <em>{[}Groups].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Sec*Level?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Managers,Deputy,/Sec*Level?/</em></p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Wipe all security first</td></tr><tr><td style="text-align:left;">-createGroups</td><td>Include this option if you want to create non-existing security groups</td></tr><tr><td style="text-align:left;">Cube 1-N</td><td>Use a separate row to specify cubes, see below for syntax. Starting from column 3 (under the corresponding group definition), you can specify the security privileges, which could be on of the following: NONE, READ, WRITE, RESERVE, ADMIN, LOCK. If ommited, the default NONE privilege will be set</td></tr></tbody></table><p><em><strong>Cube 1-N</strong></em> syntax:</p><ul><li>a cube name</li><li>a comma delimited cube list, i.e.: <em>Calendar,Employee,Job Type Assumption</em></li><li>a valid MDX expression, i.e.: <em>{[}Cubes].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Revenu?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Revenue,Employee,/*assumption*/</em></p><p><img src="/teamone/img/functions/code_cube_security.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=500785990" target="_blank" rel="noopener noreferrer">::cube.security example</a></p><div class="tip custom-block"><p class="custom-block-title">Cube dimension security</p><p>TeamOne will also set <strong>READ</strong> privilege for each cube dimension if no access was defined previously. For instance, you want to give <em>READ</em> access for <em>Group B</em> to <em>Revenue</em> cube. Previously you gave <em>WRITE</em> access for <em>Group B</em> to <em>Product</em> dimension. When setting <em>READ</em> access to <em>Revenue</em> cube, TeamOne will set <em>READ</em> access to all the dimensions in <em>Revenue</em> cube, but will keep <em>Product</em> dimension as <em>WRITE</em>.</p></div><h3 id="application-security" tabindex="-1">::application.security <a class="header-anchor" href="#application-security" aria-hidden="true">#</a></h3><p>Use <strong>::application.security</strong> block to define element security</p><p>You specify groups definitions starting from column 3. In each column you can use:</p><ul><li>a subset name in a format: <em>@SubsetName</em></li><li>a single group name</li><li>a comma delimited group list, i.e.: <em>Group 1, Group 2, Group 3</em></li><li>a valid MDX expression, i.e.: <em>{[}Groups].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Sec*Level?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Managers,Deputy,/Sec*Level?/</em></p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Wipe all security first</td></tr><tr><td style="text-align:left;">-createGroups</td><td>Include this option if you want to create non-existing security groups</td></tr><tr><td style="text-align:left;">Application 1-N</td><td>Use a separate row to specify dimension elements, see below for syntax. Starting from column 3 (under the corresponding group definition), you can specify the security privileges, which could be on of the following: NONE, READ or ADMIN. If ommited, the <em>NONE</em> privilege will be set</td></tr></tbody></table><p><em><strong>Application 1-N</strong></em> syntax:</p><ul><li>an application name</li><li>a comma delimited application list, i.e.: <em>Analysis\Employee.view,Analysis\Expenses.view</em></li><li>a valid MDX expression, i.e.: <em>&quot;{TM1DRILLDOWNMEMBER( {[}ApplicationEntries].[Analysis]}, ALL, RECURSIVE )}&quot;</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/Reports*/</em> or <em>/Reports.????/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Analysis\Employee.view,Reports*/</em></p><p><img src="/teamone/img/functions/code_application_security.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1421602536" target="_blank" rel="noopener noreferrer">::application.security example</a></p><div class="tip custom-block"><p class="custom-block-title">Default application security</p><p>Use <em>-recreate</em> option to default all application security to <em>READ</em>. Then specify which applications should be restricted using <em>NONE, READ</em> or <em>ADMIN</em> privilege.</p></div><h3 id="process-security" tabindex="-1">::process.security <a class="header-anchor" href="#process-security" aria-hidden="true">#</a></h3><p>Use <strong>::process.security</strong> block to define process security</p><p>You specify groups definitions starting from column 3. In each column you can use:</p><ul><li>a subset name in a format: <em>@SubsetName</em></li><li>a single group name</li><li>a comma delimited group list, i.e.: <em>Group 1, Group 2, Group 3</em></li><li>a valid MDX expression, i.e.: <em>{[}Groups].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or <em>/Sec*Level?/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>Managers,Deputy,/Sec*Level?/</em></p><table><thead><tr><th style="text-align:left;">Option / parameter</th><th>Description</th></tr></thead><tbody><tr><td style="text-align:left;">-recreate</td><td>Wipe all security first</td></tr><tr><td style="text-align:left;">-createGroups</td><td>Include this option if you want to create non-existing security groups</td></tr><tr><td style="text-align:left;">Process 1-N</td><td>Use a separate row to specify processes, see below for syntax. Starting from column 3 (under the corresponding group definition), you can specify the security privileges, which could be on of the following: NONE, READ. If ommited, the default NONE privilege will be set</td></tr></tbody></table><p><em><strong>Process 1-N</strong></em> syntax:</p><ul><li>a process name</li><li>a comma delimited process list, i.e.: <em>copy_version,create_version,cache_views</em></li><li>a valid MDX expression, i.e.: <em>{[}Processes].members}</em></li><li>a pattern using &quot;*&quot; (any characters) and &quot;?&quot; (any one character), i.e.: <em>/*substring*/</em> or */<em>vers?ion*/</em></li></ul><p>You can also combine elements, patterns and MDX expressions into a comma delimited list, i.e.: <em>copy_version,create_version,/*create*/</em></p><p><img src="/teamone/img/functions/code_process_security.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=1042124305" target="_blank" rel="noopener noreferrer">::process.security example</a></p><h3 id="prolog-code" tabindex="-1">::prolog.code <a class="header-anchor" href="#prolog-code" aria-hidden="true">#</a></h3><p>Use <strong>::prolog.code</strong> (you can also use just <strong>::code</strong>) block to write a prolog code It can be very handy when combining with sheets formulas, for instance, you can create and autopopulate TM1 functions based on the sheets values: <img src="/teamone/img/functions/code_prolog.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=749532791" target="_blank" rel="noopener noreferrer">::code.prolog example</a></p><h3 id="epilog-code" tabindex="-1">::epilog.code <a class="header-anchor" href="#epilog-code" aria-hidden="true">#</a></h3><p>Use <strong>::epilog.code</strong> block to write an epilog code It can be very handy when combining with sheets formulas, for instance, you can create and autopopulate TM1 functions based on the sheets values: <img src="/teamone/img/functions/code_epilog.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=398634546" target="_blank" rel="noopener noreferrer">::code.prolog example</a></p><h2 id="comments" tabindex="-1">comments <a class="header-anchor" href="#comments" aria-hidden="true">#</a></h2><p>You can use a single line and multiline comments in ::code blocks:</p><ul><li><em><strong>#</strong></em> character will comment out a single line</li><li><em><strong>#[</strong></em> and <em><strong>#]</strong></em> will comment out multiple lines</li></ul><p><img src="/teamone/img/functions/code_comments.png" alt="img"></p><p>See <a href="https://docs.google.com/spreadsheets/d/1wOI8onSk2GoOoVzSDh_EPbZj5pN5iQPPK62cDV3sr7k/edit#gid=976998592" target="_blank" rel="noopener noreferrer">comments example</a></p><h2 id="format-code" tabindex="-1">Format code <a class="header-anchor" href="#format-code" aria-hidden="true">#</a></h2><p>This function will format code and make it look like a documentation. Code formatting includes:</p><ul><li>code block header: white text and <em><strong>indigo</strong></em> background</li><li><em>-options</em>: <em><strong>italic</strong></em> text style</li><li>comments: grey text color</li><li>alternating colors background for all rows</li></ul><h2 id="run-code" tabindex="-1">Run code <a class="header-anchor" href="#run-code" aria-hidden="true">#</a></h2><p>This function will execute code blocks on the current sheet.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/teamone/doc/" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Getting started</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/teamone/doc/tasks" data-v-38ede35f><span class="text" data-v-38ede35f>Tasks</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"contact.md\":\"e0c7865c\",\"doc_features.md\":\"54071891\",\"doc_functions.md\":\"b06ed801\",\"doc_index.md\":\"6e393402\",\"doc_issues.md\":\"68f0e23c\",\"doc_model.md\":\"cd0441b5\",\"doc_sidebar.md\":\"a4f5c817\",\"doc_tasks.md\":\"4db38514\",\"doc_users.md\":\"0167601c\",\"faq.md\":\"d4adc122\",\"index.md\":\"7b9582a8\",\"privacy.md\":\"95c721b0\",\"terms.md\":\"88a74d1c\"}")</script>
    <script type="module" async src="/teamone/assets/app.7bb46320.js"></script>
    
  </body>
</html>